
       IDENTIFICATION DIVISION.
       PROGRAM-ID. LIST-REVERSAL-DEMO.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 ORIGINAL-LIST.
          05 LIST-ITEM OCCURS 5 TIMES PIC X(10).
       
       01 REVERSED-LIST.
          05 REV-LIST-ITEM OCCURS 5 TIMES PIC X(10).

       01 STACK-AREA.
          05 STACK-ELEMENT OCCURS 5 TIMES PIC X(10).
          05 STACK-TOP PIC 9(2) VALUE 0.

       01 I PIC 9(2).
       01 N PIC 9(2) VALUE 5.

       PROCEDURE DIVISION.

       MOVE "1" TO LIST-ITEM(1).
       MOVE "2" TO LIST-ITEM(2).
       MOVE "3" TO LIST-ITEM(3).
       MOVE "4" TO LIST-ITEM(4).
       MOVE "5" TO LIST-ITEM(5).

       DISPLAY "Lista original: " 
       PERFORM VARYING I FROM 1 BY 1 UNTIL I > N
           DISPLAY FUNCTION TRIM(LIST-ITEM(I)) WITH NO ADVANCING " "
       END-PERFORM.
       DISPLAY " ".

       PERFORM REVERSE-LIST-RECURSIVE.

       DISPLAY "Lista invertida: " 
       PERFORM VARYING I FROM 1 BY 1 UNTIL I > N
           DISPLAY FUNCTION TRIM(REV-LIST-ITEM(I)) WITH NO ADVANCING " "
       END-PERFORM.
       DISPLAY " ".

       STOP RUN.

       REVERSE-LIST-RECURSIVE.
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > N
               ADD 1 TO STACK-TOP
               MOVE LIST-ITEM(I) TO STACK-ELEMENT(STACK-TOP)
           END-PERFORM.

           PERFORM VARYING I FROM 1 BY 1 UNTIL I > N
               MOVE STACK-ELEMENT(STACK-TOP) TO REV-LIST-ITEM(I)
               SUBTRACT 1 FROM STACK-TOP
           END-PERFORM.
